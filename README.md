This repository includes an R package for implementing joint mean-covariance estimation using 
the generalized mean-covariance bridge (GMCB) prior and code for replicating the simulations
and corresponding plots in 
[_A Bayesian Generalized Bridge Regression Approach to Covariance Estimation in the Presence of Covariates_](https://arxiv.org/abs/2406.00906).

#### GMCB

This subdirectory contains the files necessary to install the GMCB package, which
can be installed with `devtools::install_github`:

```r
library(devtools)
devtools::install_github(repo = "czhao15103/GMCB/GMCB")
```

#### Simulations

This subdirectory contains files to replicate the simulations and plots in the paper. The file `HSGHS.m`, which
was used to obtain results from the HS-GHS method, was obtained from the [HS_GHS repostitory](https://github.com/liyf1988/HS_GHS),
and the file `GHS.m`, which was used to obtain results from the GHS method, was obtained from the [GHS repository](https://github.com/liyf1988/GHS).

A brief description of the files is given below.

- Data generating files
	- Files with names that begin with `Data_` generate the datasets used for the simulations.
	- Files with names that begin with `matlab_data_` convert the datasets generated by the `Data_` files for use with HS-GHS, 
which is implemented in MATLAB.
	- The files `n40p1q50_RDStoCSV.R` and `HSGHS_data_n40p30q50.R` are also used to convert certain datasets to csv files for MATLAB.
- Method files
	- These files perform the simulations.
	- Files are named using the method and data scenario used in the file. For example, the file `GMCBMH_moderatesparseAR.R"
uses the GMCB-MH algorithm for the data scenario labeled "AR1, moderate, sparse signals"
	- Files that end with `_ComputationAssessment` assess the runtimes and multivariate effective sample sizes for the 
corresponding methods and data scenarios.
	- Files that end with `_CICoverage` assess the frequentist coverage of posterior credible intervals.
- Results files
	- These files have names beginning with `Results_` and compile the output from the method files.
- Plotting files
	- These files were used to produce plots in the paper.
	- `Plots_GBRDensity.R` produces plots of the generalized bridge prior density.
	- Files with names that begin with `acf_` produce acf plots for the simulation scenarios.
- MATLAB files
	- These files were used to implement HS-GHS and GHS.

#### Sitka

This subdirectory contains files to replicate the Sitka spruce example in the paper.

A brief description of the files is given below.

- Data preparation and plotting
	- Sitka.R
- Model fitting
	- GMCBMH_1988.R
 	- GMCBSMN_1988.R
  	- The `.rds` files contain the starting parameters for this code.
- Leave-one-out (LOO) posterior predictive checks
	- LOOPPC_MH_0112001.R
 	- LOOPPC_MH_114005.R
  	- LOOPPC_SMN_0112001.R
  	- LOOPPC_SMN_114005.R
- Results files
	- LOOPPC_Results.R examines the LOO posterior predictive check results
 	- Sitka_Results.R examines the model output from the code listed under "Model fitting"
